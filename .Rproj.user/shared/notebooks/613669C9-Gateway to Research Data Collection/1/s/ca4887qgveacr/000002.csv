"0","# init auxiliary df lists which will be later combined to make the auxiliary dfs"
"0","person_df <- tibble()"
"0","organisation_df <- tibble()"
"0","subject_df <- tibble()"
"0","topic_df <- tibble()"
"0",""
"0","# start logging"
"0","log_file_dest <- paste0(""../logs/"", format(Sys.time(), ""%Y%m%d_%H%M%S_""), ""log.log"")"
"0","log_file <- log_open(log_file_dest, logdir = FALSE)"
"0",""
"0","for (i in seq_along(project_df$project_reference)) {"
"0","  # extract the project URL"
"0","  project_url <- project_df$gtr_project_url[i]"
"0","  "
"0","  # extract the project reference number for use in the other dataframes"
"0","  project_ref <- project_df$project_reference[i]"
"0","  "
"0","  # check and correct for faulty urls by rebuilding them"
"0","  project_type <- project_df$project_category[i]"
"0","  "
"0","  if (project_type == ""Studentship"") {"
"0","    # build correct Studentship URL with project ref number"
"0","    project_url <- paste(""https://gtr.ukri.org/projects?ref=studentship-"", project_ref, collapse = """", sep = """")"
"0","    # save corrected URL in dataframe"
"0","    project_df$gtr_project_url[i] <- project_url"
"0","  } else {"
"0","    # build correct Studentship URL with project ref number"
"0","    project_url <- paste(""https://gtr.ukri.org/projects?ref="", project_ref, collapse = """", sep = """")"
"0","    # save corrected URL in dataframe"
"0","    project_df$gtr_project_url[i] <- project_url"
"0","  }"
"0","  "
"0","  # Log progress"
"0","  log_print(paste(i, project_url, project_ref, sep = "", ""), console = FALSE)"
"0","  # extract JSON data from URL target"
"0","  start_time <- Sys.time()"
"0","  "
"0","  project_info <- fromJSON("
"0","    project_url,"
"0","    simplifyDataFrame = TRUE,"
"0","    flatten = TRUE)"
"0","  "
"0","  end_time <- Sys.time()"
"0","  "
"0","  # calculate wait time"
"0","  wait_time <- end_time - start_time"
"0","  "
"0","  # extract abstract and assign it to the relevant cell"
"0","  abstract <- project_info$projectOverview$projectComposition$project$abstractText"
"0","  project_df$abstract[i] <- abstract"
"0","  "
"0","  # add to person df"
"0","  personRole <- as_tibble(project_info$projectOverview$projectComposition$personRole) %>% "
"0","    add_column(project.ref = project_ref, .before = 1)"
"0","  "
"0","  person_df %<>% bind_rows(personRole)"
"0","  "
"0","  # add to organisation df"
"0","  organisationRole <- as_tibble(project_info$projectOverview$projectComposition$organisationRole) %>% "
"0","    add_column(project.ref = project_ref, .before = 1)"
"0","  "
"0","  organisation_df %<>% bind_rows(organisationRole)"
"0","  "
"0","  # add to research_subject df"
"0","  researchSubject <- as_tibble(project_info$projectOverview$projectComposition$project$researchSubject) %>% "
"0","    add_column(project.ref = project_ref, .before = 1)"
"0","  "
"0","  subject_df %<>% bind_rows(researchSubject)"
"0","  "
"0","  # add to research_topic df"
"0","  researchTopic <- as_tibble(project_info$projectOverview$projectComposition$project$researchTopic) %>% "
"0","    add_column(project.ref = project_ref, .before = 1)"
"0","  "
"0","  topic_df %<>% bind_rows(researchTopic)"
"0","  "
"0","  Sys.sleep(wait_time)"
"0","}"
"2","cannot open file '../logs/20210627_171640_log.log': Permission denied"
"1","[1]"
"1"," ""Error: Object cannot be printed to log\n"""
"1","
"
"1","NOTE: Log Print Time:  2021-06-27 17:43:46"
"1"," "
"1","
"
"1","NOTE: Elapsed Time in seconds: 0.894587993621826"
"1"," "
"1","
"
"1","
"
"2","no sink to remove"
"2","Error in open.connection(con, ""rb"") : 
  Timeout was reached: [gtr.ukri.org] Connection timed out after 10003 milliseconds
"
"1","[1]"
"1"," ""Error in open.connection(con, \""rb\"") : \n  Timeout was reached: [gtr.ukri.org] Connection timed out after 10003 milliseconds\n"""
"1","
"
