"0","themes <- theme_df %>% "
"0","  select("
"0","    grant_ref,"
"0","    theme_name,"
"0","    theme_type,"
"0","    theme_research_area = research_area"
"0","  ) %>% "
"0","  group_by(theme_name, theme_research_area) %>% "
"0","  mutate("
"0","    theme_id = UUIDgenerate()"
"0","  ) %>% "
"0","  ungroup() "
"0",""
"0","grant_themes <- themes %>% "
"0","  select("
"0","    grant_ref,"
"0","    theme_id"
"0","  )"
"0",""
"0","themes <- themes %>% "
"0","  select("
"0","    theme_id,"
"0","    theme_type,"
"0","    theme_name,"
"0","    theme_research_area"
"0","  ) %>% "
"0","  distinct() %>% "
"0","  mutate("
"0","    across("
"0","      c(theme_name, theme_type, theme_research_area),"
"0","      as_factor"
"0","    )"
"0","  )"
"0",""
"0","dataset_collection$grant_themes <- grant_themes"
"0","dataset_collection$themes <- themes"
